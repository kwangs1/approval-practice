<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.approval">
	<resultMap id="approvalResult" type="approvalVO">
		<result property="appr_seq" column="appr_seq" />
		<result property="name" column="name" />
		<result property="id" column="id" />
		<result property="regdate" column="regdate" />
		<result property="title" column="title" />
		<result property="content" column="content" />
		<result property="startdate" column="startdate" />
		<result property="enddate" column="enddate" />
		<result property="status" column="status" />
	</resultMap>

<select id="getLatestReceiptsSeq" resultType="java.lang.String">
   SELECT 'APPROVAL' || to_char(sysdate, 'YYYYMMDD') || lpad(appr_seq.currval, 5, '0') FROM DUAL
</select>


<insert id="apprView" parameterType="approvalVO" useGeneratedKeys="true" keyProperty="receipts_seq"> 
insert into approval
values(#{appr_seq},#{name},#{id},sysdate,#{title},#{content},#{startdate},#{enddate},100)
</insert>

<select id="apprWaitList" resultType="approvalVO">
select a.*,p.*
	from  approval a, participant p
where p.appr_seq = a.appr_seq
and p.participant_seq = (select p.participant_seq from participant p where p.appr_seq = a.appr_seq )
and p.approvalstatus = 4098
and p.id = #{id}
and p.approvaltype = 4
</select>

<select id="apprInfo" resultType="approvalVO" parameterType="String">
select * from approval where appr_seq = #{appr_seq}
</select>

</mapper>